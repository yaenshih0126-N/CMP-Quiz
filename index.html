<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Marketplace çŸ¥è­˜å¤§æŒ‘æˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #ffcc00; 
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 15px;
        }

        .glass-card {
            background: #ffffff;
            border-radius: 28px;
            box-shadow: 0 25px 50px -12px rgba(184, 147, 0, 0.4);
            overflow: hidden;
            width: 100%;
            max-width: 450px;
            position: relative;
        }

        .option-btn {
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #f1f5f9;
        }

        .option-btn:hover:not(.correct):not(.wrong) {
            border-color: #ffcc00;
            background-color: #fffbeb;
            transform: scale(1.02);
        }

        .option-btn.correct {
            background-color: #10b981 !important;
            color: white !important;
            border-color: #059669 !important;
        }

        .option-btn.wrong {
            background-color: #d40511 !important;
            color: white !important;
            border-color: #9b1c1c !important;
        }

        .progress-bar-fill {
            height: 100%;
            background: #d40511;
            transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .input-field {
            border: 2px solid #f1f5f9;
            transition: border-color 0.3s;
        }

        .input-field:focus {
            border-color: #d40511;
            outline: none;
        }

        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(212, 5, 17, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(212, 5, 17, 0); }
            100% { box-shadow: 0 0 0 0 rgba(212, 5, 17, 0); }
        }

        .btn-active-red {
            animation: pulse-red 2s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }
        .shake { animation: shake 0.4s ease-in-out; }
    </style>
</head>
<body>

<div id="app" class="glass-card flex flex-col min-h-[620px]">
    
    <div id="game-header" class="hidden">
        <div class="h-2 bg-gray-100 w-full">
            <div id="progress-fill" class="progress-bar-fill" style="width: 0%"></div>
        </div>
        <div class="px-6 py-4 flex justify-between items-center border-b">
            <span class="text-[#d40511] font-black italic text-lg tracking-tighter">CMP QUIZ</span>
            <span class="text-xs font-bold text-gray-400 bg-gray-50 px-3 py-1 rounded-full border">
                é¡Œç›® <span id="current-idx">1</span> / 5
            </span>
        </div>
    </div>

    <div class="p-8 flex-grow flex flex-col justify-center">
        <!-- é–‹å§‹èˆ‡å¯¦ååˆ¶ç•«é¢ -->
        <div id="start-screen" class="text-center">
            <div class="relative w-24 h-24 mx-auto mb-6">
                <div class="absolute inset-0 bg-[#d40511] rounded-full opacity-10 animate-ping"></div>
                <div class="relative bg-[#d40511] text-white w-24 h-24 rounded-3xl flex items-center justify-center shadow-xl transform rotate-6">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="#ffcc00">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                </div>
            </div>
            
            <h1 class="text-2xl font-black text-gray-800 mb-2 tracking-tight">Career Marketplace çŸ¥å¤šå°‘</h1>
            <p class="text-gray-500 mb-6 font-medium text-sm">è«‹è¼¸å…¥è³‡è¨Šé–‹å§‹æ¸¬é©—</p>
            
            <div class="space-y-4 mb-8">
                <div class="text-left">
                    <label class="text-xs font-bold text-gray-400 uppercase ml-1">å“¡å·¥ç·¨è™Ÿ Staff ID</label>
                    <input type="text" id="staff-id" class="input-field w-full p-4 rounded-xl mt-1 text-gray-700 font-bold" placeholder="ä¾‹å¦‚: 123456">
                </div>
                <div class="text-left">
                    <label class="text-xs font-bold text-gray-400 uppercase ml-1">ä¸­æ–‡å§“å Name</label>
                    <input type="text" id="user-name" class="input-field w-full p-4 rounded-xl mt-1 text-gray-700 font-bold" placeholder="ä¾‹å¦‚: ç‹å¤§æ˜">
                </div>
            </div>
            
            <button onclick="checkAndStart()" class="w-full bg-[#d40511] text-white py-5 rounded-2xl font-black text-xl shadow-2xl hover:bg-[#b3040e] transition-all transform active:scale-95 btn-active-red">
                é–‹å§‹æŒ‘æˆ°
            </button>
        </div>

        <div id="quiz-screen" class="hidden flex-grow flex flex-col">
            <div class="mb-10">
                <h2 id="question-text" class="text-2xl font-black text-gray-800 leading-snug">
                    è¼‰å…¥ä¸­...
                </h2>
            </div>
            <div id="options-grid" class="space-y-4 mt-auto"></div>
        </div>

        <div id="result-screen" class="hidden text-center">
            <div id="result-badge" class="text-7xl mb-4">ğŸ†</div>
            <h2 class="text-3xl font-black text-gray-800 mb-2">æ¸¬é©—å®Œæˆï¼</h2>
            <p id="result-evaluation" class="text-gray-500 mb-6 font-medium">æ‚¨çš„è·æ¶¯æŒæ¡å¯¦åŠ›ç‚º</p>
            
            <div class="bg-yellow-50 rounded-[2.5rem] py-8 mb-6 border-4 border-[#ffcc00] shadow-inner">
                <div id="final-score" class="text-7xl font-black text-[#d40511]">0</div>
                <div class="text-yellow-600 font-bold text-sm uppercase mt-1 tracking-widest">Total Score</div>
            </div>

            <div class="bg-red-50 border-l-4 border-[#d40511] p-4 mb-8 text-left rounded-r-lg">
                <p class="text-[#d40511] font-bold text-sm leading-relaxed text-center">
                    æ­å–œå®Œæˆæ¸¬é©—ï¼é»æ“Šä¸‹æ–¹æŒ‰éˆ•æäº¤çµæœåƒèˆ‡æŠ½çã€‚
                </p>
            </div>

            <button id="submit-btn" onclick="submitToSheet()" class="w-full bg-gray-900 text-white py-5 rounded-2xl font-black text-lg hover:bg-black transition shadow-xl active:scale-95">
                æäº¤åƒèˆ‡æŠ½ç
            </button>
            <p id="submit-status" class="mt-4 text-sm font-bold text-gray-400 hidden italic">æ­£åœ¨æäº¤çµæœ...</p>
        </div>
    </div>
    
    <div class="p-6 text-center text-gray-300 text-[10px] font-bold uppercase tracking-[0.25em] border-t border-gray-50">
        Career Marketplace â€¢ Future Ready
    </div>
</div>

<script>
    // æ›¿æ›æˆæ‚¨çš„ Google Apps Script éƒ¨ç½² URL
    const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE'; 

    const BGM_SRC = 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3';
    const WIN_SRC = 'https://actions.google.com/sounds/v1/human_voices/crowd_cheer.ogg';

    const mainBGM = new Audio(BGM_SRC);
    const winSfx = new Audio(WIN_SRC);

    mainBGM.loop = true;
    mainBGM.volume = 0.25;
    winSfx.volume = 0.8;

    const quizData = [
        { 
            q: "1. Career Marketplace (CMP) é è¨ˆåœ¨ä»€éº¼æ™‚å€™å…¨é¢å–ä»£ My Talent Worldï¼Ÿ", 
            o: ["A. 2025 Q4", "B. 2026 Q2", "C. 2027 Q1"], 
            a: 1 
        },
        { 
            q: "2. Career Marketplace çš„å…©å¤§æ ¸å¿ƒç‰¹è‰²æ˜¯ä»€éº¼ï¼Ÿ", 
            o: ["A. æŠ€èƒ½å°å‘æ–¹æ³• & å€‹äººåŒ–å°ˆå±¬æˆé•·å·¥å…·ç®±", "B. å…¨çƒè·ç¼ºæœå°‹ & è–ªè³‡é€æ˜åŒ–", "C. å³æ™‚ç¸¾æ•ˆçé‡‘ & é è·å·¥ä½œå¹³å°"], 
            a: 0 
        },
        { 
            q: "3. Career Marketplace æä¾›å“ªä¸‰å¤§æ ¸å¿ƒåŠŸèƒ½ï¼Ÿ", 
            o: ["A. æ¨è–¦æ—…éŠã€æ¨è–¦é¤å»³ã€æ¨è–¦é›»å½±", "B. æ¨è–¦ä¸»ç®¡ã€æ¨è–¦åœ˜éšŠã€æ¨è–¦è¾¦å…¬å®¤", "C. æ¨è–¦è·ç¼ºã€æ¨è–¦å­¸ç¿’èª²ç¨‹ã€æ¨è–¦æŠ€èƒ½"], 
            a: 2 
        },
        { 
            q: "4. Career Marketplace çš„ç™»å…¥æ–¹å¼æ˜¯ä»€éº¼ï¼Ÿ", 
            o: ["A. é€²åˆ° DHL å®˜ç¶²", "B. é€é Smart Connect App æˆ–ç¶²é ç™»å…¥ï¼Œåœ¨ã€Œæ‡‰ç”¨ç¨‹å¼ã€å…§", "C. ç”¨ç¤¾ç¾¤å¸³è™Ÿç™»å…¥"], 
            a: 1 
        },
        { 
            q: "5. Career Marketplace ç‚ºåŒä»å¸¶ä¾†çš„å¥½è™•åŒ…æ‹¬å“ªäº›ï¼Ÿ", 
            o: ["A. æ›´é«˜é€æ˜åº¦", "B. æŒæ¡è·æ¶¯æ–¹å‘", "C. æ¢ç´¢èˆ‡ç™¼å±•", "D. ä»¥ä¸Šçš†æ˜¯"], 
            a: 3 
        }
    ];

    let currentIndex = 0;
    let score = 0;
    let isLocked = false;
    let userData = { id: '', name: '' };

    function checkAndStart() {
        const idInput = document.getElementById('staff-id').value.trim();
        const nameInput = document.getElementById('user-name').value.trim();

        if (!idInput || !nameInput) {
            alert("è«‹å¡«å¯«å®Œæ•´çš„è·ç·¨èˆ‡ä¸­æ–‡å§“åï¼");
            return;
        }

        userData.id = idInput;
        userData.name = nameInput;
        startGame();
    }

    function startGame() {
        mainBGM.load();
        winSfx.load();
        mainBGM.play().catch(e => console.log("BGM æ’­æ”¾å—é˜»"));

        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('game-header').classList.remove('hidden');
        document.getElementById('quiz-screen').classList.remove('hidden');
        showQuestion();
    }

    function showQuestion() {
        isLocked = false;
        const currentQ = quizData[currentIndex];
        document.getElementById('current-idx').innerText = currentIndex + 1;
        document.getElementById('question-text').innerText = currentQ.q;
        
        const progress = (currentIndex / quizData.length) * 100;
        document.getElementById('progress-fill').style.width = `${progress}%`;

        const optionsGrid = document.getElementById('options-grid');
        optionsGrid.innerHTML = '';

        currentQ.o.forEach((option, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn w-full p-5 rounded-2xl text-left font-bold text-gray-700 bg-white shadow-sm';
            btn.innerText = option;
            btn.onclick = () => checkAnswer(index, btn);
            optionsGrid.appendChild(btn);
        });
    }

    function checkAnswer(selectedIndex, btn) {
        if (isLocked) return;
        isLocked = true;

        const correctIndex = quizData[currentIndex].a;
        if (selectedIndex === correctIndex) {
            btn.classList.add('correct');
            score += (100 / quizData.length);
        } else {
            btn.classList.add('wrong');
            document.getElementById('app').classList.add('shake');
            setTimeout(() => document.getElementById('app').classList.remove('shake'), 400);
            document.querySelectorAll('.option-btn')[correctIndex].classList.add('correct');
        }

        setTimeout(() => {
            currentIndex++;
            if (currentIndex < quizData.length) {
                showQuestion();
            } else {
                showFinalResult();
            }
        }, 1200);
    }

    function showFinalResult() {
        mainBGM.pause();
        mainBGM.currentTime = 0;
        
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('game-header').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        
        winSfx.currentTime = 0;
        winSfx.play().catch(e => console.log("éŸ³æ•ˆå—é™"));

        const finalScore = Math.round(score);
        document.getElementById('final-score').innerText = finalScore;
        const evalText = document.getElementById('result-evaluation');

        if (finalScore === 100) {
            evalText.innerText = `å®Œç¾æŒæ¡ï¼${userData.name}ï¼Œæ‚¨æ˜¯ CMP å°ˆå®¶ï¼`;
        } else if (finalScore >= 60) {
            evalText.innerText = `åšå¾—å¥½ï¼Œ${userData.name}ï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡ã€‚`;
        } else {
            evalText.innerText = `åŠ æ²¹ï¼Œ${userData.name}ï¼å†å¤šæ¢ç´¢å¹³å°åŠŸèƒ½ã€‚`;
        }
    }

    async function submitToSheet() {
        const btn = document.getElementById('submit-btn');
        const status = document.getElementById('submit-status');
        
        btn.disabled = true;
        btn.innerText = "æäº¤ä¸­...";
        status.classList.remove('hidden');

        const payload = {
            staffId: userData.id,
            name: userData.name,
            score: Math.round(score),
            timestamp: new Date().toLocaleString()
        };

        // é€™è£¡ç¤ºç¯„ fetch é‚è¼¯ï¼Œéœ€é…åˆå¾Œç«¯ script ä½¿ç”¨
        try {
            // æ³¨æ„ï¼šè·¨ç¶²åŸŸæäº¤é€šå¸¸éœ€è¦ä½¿ç”¨ Google Apps Script çš„ doPost æˆ–æ¨¡æ“¬è¡¨å–®æäº¤
            console.log("æäº¤æ•¸æ“š:", payload);
            
            // å»¶é²æ¨¡æ“¬ç¶²è·¯è«‹æ±‚
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            status.innerText = "âœ… æäº¤æˆåŠŸï¼ç¥æ‚¨å¹¸é‹ä¸­çï¼";
            btn.innerText = "å·²æäº¤æˆåŠŸ";
            btn.classList.remove('bg-gray-900');
            btn.classList.add('bg-green-600');
        } catch (error) {
            status.innerText = "âŒ æäº¤å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šå¾Œå†è©¦ã€‚";
            btn.disabled = false;
            btn.innerText = "é‡æ–°æäº¤åƒèˆ‡æŠ½ç";
        }
    }
</script>

</body>
</html>
